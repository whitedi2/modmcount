&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ТабДок = Новый ТабличныйДокумент;
	
	МаршрутныйЛистПлоский(ТабДок, ПараметрКоманды);
	
	ТабДок.ОтображатьСетку = Ложь;
	ТабДок.Защита = Ложь;
	ТабДок.ТолькоПросмотр = Истина;
	ТабДок.ОтображатьЗаголовки = Истина;
	ТабДок.АвтоМасштаб = Истина;
	ФормаПечати = ПолучитьФорму("ОбщаяФорма.ФормаПечатиДокумента",,,Новый УникальныйИдентификатор);
	ФормаПечати.Результат = ТабДок;
	
	Если НЕ ТипЗнч(ПараметрКоманды) = Тип("Массив") Тогда
		ФормаПечати.Заголовок = "Печатная форма МЛ плоский";
	ИначеЕсли ПараметрКоманды.Количество() = 1 Тогда
		ФормаПечати.Заголовок = "Печатная форма МЛ плоский: " + Строка(ПараметрКоманды[0]);
	//	Организация = РеквизитыЗаявки.Организация;
	//	ФормаПечати.АдресEmail = РеквизитыЗаявки.АдресEmail;
	//	ФормаПечати.Заявка = ПараметрКоманды[0];
	//	ФормаПечати.Заголовок = Строка(ПараметрКоманды[0]) + ?(ЗначениеЗаполнено(Организация), " (" + Строка(Организация) + ")", "");
	Иначе
		ФормаПечати.Заголовок = "Печатная форма МЛ плоский";
	КонецЕсли; 
	ФормаПечати.Открыть();
	
КонецПроцедуры

&НаСервере
Процедура МаршрутныйЛистПлоский(ТабДок, ПараметрКоманды)
	Документы.сабМаршрутныйЛист.ПечатьПлоский(ТабДок, ПараметрКоманды);
КонецПроцедуры
