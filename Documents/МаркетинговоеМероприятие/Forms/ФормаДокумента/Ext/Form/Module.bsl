
&НаКлиенте
Процедура ПериодЗаказовПриИзменении(Элемент)
	
	Объект.ДатаЗаказовНач = ПериодЗаказов.ДатаНачала;
	Объект.ДатаЗаказовКон = ПериодЗаказов.ДатаОкончания;
	
КонецПроцедуры

&НаКлиенте
Процедура ПериодПоставкиПриИзменении(Элемент)
	
	Объект.ДатаПоставокНач = ПериодПоставки.ДатаНачала;
	Объект.ДатаПоставокКон = ПериодПоставки.ДатаОкончания;
	
КонецПроцедуры

&НаКлиенте
Процедура ПериодРеализацииПриИзменении(Элемент)
	
	Объект.ДатаРеализацииНач = ПериодРеализации.ДатаНачала;
	Объект.ДатаРеализацииКон = ПериодРеализации.ДатаОкончания;
	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ПериодЗаказов.ДатаНачала = Объект.ДатаЗаказовНач;
	ПериодЗаказов.ДатаОкончания = Объект.ДатаЗаказовКон;
	ПериодПоставки.ДатаНачала = Объект.ДатаПоставокНач;
	ПериодПоставки.ДатаОкончания = Объект.ДатаПоставокКон;
	ПериодРеализации.ДатаНачала = Объект.ДатаРеализацииНач;
	ПериодРеализации.ДатаОкончания = Объект.ДатаРеализацииКон;	
	
КонецПроцедуры

&НаКлиенте
Процедура ПередЗаписью(Отказ, ПараметрыЗаписи)
	
	Объект.ДатаЗаказовКон = КонецДня(Объект.ДатаЗаказовКон);
	Объект.ДатаПоставокКон = КонецДня(Объект.ДатаПоставокКон);
	Объект.ДатаРеализацииКон = КонецДня(Объект.ДатаРеализацииКон);
	
КонецПроцедуры

&НаСервере
Процедура ЗаполнитьНаСервере()
		
	Объект.Подразделения.Очистить();	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	СтруктураПредприятия.Ссылка КАК Ссылка
		|ИЗ
		|	Справочник.СтруктураПредприятия КАК СтруктураПредприятия
		|ГДЕ
		|	СтруктураПредприятия.Владелец = &Владелец
		|	И СтруктураПредприятия.ПометкаУдаления = ЛОЖЬ";
	
	Запрос.УстановитьПараметр("Владелец", Объект.Предприятие);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Строка = Объект.Подразделения.Добавить();
		Строка.Подразделение = ВыборкаДетальныеЗаписи.Ссылка;
	КонецЦикла;
	
КонецПроцедуры

&НаКлиенте
Процедура Заполнить(Команда)
	Если Объект.Подразделения.Количество() > 0 Тогда  
		Если Вопрос("Табличная часть будет очищена.Вы уверены", РежимДиалогаВопрос.ДаНет) = КодВозвратаДиалога.Да  Тогда	
			ЗаполнитьНаСервере();
		КонецЕсли;
	Иначе
		ЗаполнитьНаСервере();
	КонецЕсли;
КонецПроцедуры
