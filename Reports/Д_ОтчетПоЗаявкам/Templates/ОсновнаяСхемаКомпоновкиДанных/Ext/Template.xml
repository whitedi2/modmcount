<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>НаборДанных1</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Счет</dataPath>
			<field>Счет</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСчет</dataPath>
			<field>КорСчет</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто1</dataPath>
			<field>КорСубконто1</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто2</dataPath>
			<field>КорСубконто2</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто3</dataPath>
			<field>КорСубконто3</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто1</dataPath>
			<field>Субконто1</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто2</dataPath>
			<field>Субконто2</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто3</dataPath>
			<field>Субконто3</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Заявлено</dataPath>
			<field>Заявлено</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ИнвПроект</dataPath>
			<field>ИнвПроект</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Отклонение</dataPath>
			<field>Отклонение</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>План1</dataPath>
			<field>План1</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>План2</dataPath>
			<field>План2</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>План3</dataPath>
			<field>План3</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>План4</dataPath>
			<field>План4</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Подразделение</dataPath>
			<field>Подразделение</field>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПодразделениеКор</dataPath>
			<field>ПодразделениеКор</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Предприятия</dataPath>
			<field>Предприятия</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтатьяДДС</dataPath>
			<field>СтатьяДДС</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СценарийПлана</dataPath>
			<field>СценарийПлана</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Факт</dataPath>
			<field>Факт</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФактВсего</dataPath>
			<field>ФактВсего</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЦФО</dataPath>
			<field>ЦФО</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПланНаСогласовании</dataPath>
			<field>ПланНаСогласовании</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>План на согласовании</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>План_четыре</dataPath>
			<field>План_четыре</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>План четыре</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаДДС</dataPath>
			<field>СуммаДДС</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма ДДС</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Исполнено</dataPath>
			<field>Исполнено</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Исполнено</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Ссылка</dataPath>
			<field>Ссылка</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Дата</dataPath>
			<field>Дата</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Статья</dataPath>
			<field>Статья</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Статья</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Контрагент</dataPath>
			<field>Контрагент</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ИнвПроектКод</dataPath>
			<field>ИнвПроектКод</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Валюта</dataPath>
			<field>Валюта</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВалютаКор</dataPath>
			<field>ВалютаКор</field>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ТекЗаявка.СтатьяДДС КАК СтатьяДДС,
	СУММА(ЕСТЬNULL(ТекЗаявка.СуммаДДС, 0)) КАК ФактВсего,
	ТекЗаявка.ЦФО КАК ЦФО,
	ТекЗаявка.Подразделение КАК Подразделение,
	ТекЗаявка.ИнвПроект КАК ИнвПроект,
	СУММА(ТекЗаявка.Исполнено) КАК Факт,
	СУММА(ЕСТЬNULL(ТекЗаявка.СуммаДДС, 0) - ТекЗаявка.Исполнено) КАК Заявлено,
	ЕСТЬNULL(План.План1, 0) КАК План1,
	ЕСТЬNULL(План.План2, 0) КАК План2,
	ЕСТЬNULL(План.План3, 0) КАК План3,
	ЕСТЬNULL(План.План4, 0) КАК План4,
	ЕСТЬNULL(План.План_четыре, 0) - ЕСТЬNULL(ТекЗаявка.СуммаДДС, 0) КАК Отклонение,
	ЕСТЬNULL(План.ПланНаСогласовании, 0) КАК ПланНаСогласовании,
	ТекЗаявка.ИнвПроектКод КАК ИнвПроектКод
ИЗ
	(ВЫБРАТЬ
		ВложенныйЗапрос.СтатьяДДС КАК СтатьяДДС,
		СУММА(ВложенныйЗапрос.СуммаДДС) КАК СуммаДДС,
		ВложенныйЗапрос.ЦФО КАК ЦФО,
		ВложенныйЗапрос.Подразделение КАК Подразделение,
		ВложенныйЗапрос.ИнвПроект КАК ИнвПроект,
		КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ВложенныйЗапрос.Исполнено) КАК Исполнено,
		ВложенныйЗапрос.ИнвПроектКод КАК ИнвПроектКод
	ИЗ
		(ВЫБРАТЬ
			Д_ЗаявкаНаОплатуЗаявкаБезнал.СтатьяДДС КАК СтатьяДДС,
			СУММА(ВЫБОР
					КОГДА Д_ЗаявкаНаАвансовыйОтчетСтрокиЗаявкиНаОплату.Ссылка ЕСТЬ NULL
						ТОГДА Д_ЗаявкаНаОплатуЗаявкаБезнал.СуммаДДС
					ИНАЧЕ 0
				КОНЕЦ) КАК СуммаДДС,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.ЦФО КАК ЦФО,
			ВЫБОР
				КОГДА Д_ЗаявкаНаОплатуЗаявкаБезнал.ЦФО.УчетПоПодразделениям
					ТОГДА Д_ЗаявкаНаОплатуЗаявкаБезнал.Подразделение
				ИНАЧЕ "Основное"
			КОНЕЦ КАК Подразделение,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.Ссылка КАК Ссылка,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.Ссылка.Дата КАК Дата,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.ИнвПроект КАК ИнвПроект,
			СУММА(ВЫБОР
					КОГДА Согласование1.Завершен = ИСТИНА
						ТОГДА Д_ЗаявкаНаОплатуЗаявкаБезнал.СуммаДДС
					ИНАЧЕ 0
				КОНЕЦ) КАК Исполнено,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.Контрагент КАК Контрагент,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.ИнвПроект.Код КАК ИнвПроектКод
		ИЗ
			Документ.Д_ЗаявкаНаОплату.ЗаявкаБезнал КАК Д_ЗаявкаНаОплатуЗаявкаБезнал
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Согласование1 КАК Согласование1
				ПО Д_ЗаявкаНаОплатуЗаявкаБезнал.Ссылка = Согласование1.Заявка
					И (Согласование1.ПометкаУдаления = ЛОЖЬ)
				ЛЕВОЕ СОЕДИНЕНИЕ Документ.Д_ЗаявкаНаАвансовыйОтчет.СтрокиЗаявкиНаОплату КАК Д_ЗаявкаНаАвансовыйОтчетСтрокиЗаявкиНаОплату
				ПО Д_ЗаявкаНаОплатуЗаявкаБезнал.УИДСтроки = Д_ЗаявкаНаАвансовыйОтчетСтрокиЗаявкиНаОплату.УИДСтрокиДокОснования
					И (НЕ Д_ЗаявкаНаОплатуЗаявкаБезнал.УИДСтроки = "")
					И (Д_ЗаявкаНаАвансовыйОтчетСтрокиЗаявкиНаОплату.Ссылка.ПометкаУдаления = ЛОЖЬ)
					И Д_ЗаявкаНаОплатуЗаявкаБезнал.Ссылка = Д_ЗаявкаНаАвансовыйОтчетСтрокиЗаявкиНаОплату.ДокОснование
					И (НЕ &amp;ИсключатьАвансовые)
		ГДЕ
			Д_ЗаявкаНаОплатуЗаявкаБезнал.Ссылка.ПометкаУдаления = ЛОЖЬ
			И Д_ЗаявкаНаОплатуЗаявкаБезнал.Ссылка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
			И Д_ЗаявкаНаОплатуЗаявкаБезнал.ОтменаОплаты = ЛОЖЬ
			И (Д_ЗаявкаНаОплатуЗаявкаБезнал.Ссылка.Предприятие В (&amp;ДоступныеПредприятия)
					ИЛИ Д_ЗаявкаНаОплатуЗаявкаБезнал.ЦФО В (&amp;ДоступныеПредприятия)
					ИЛИ Д_ЗаявкаНаОплатуЗаявкаБезнал.Ссылка.Автор В (&amp;Автор))
			И Согласование1.НеСогласовано = ЛОЖЬ
			И ЛОЖЬ
		
		СГРУППИРОВАТЬ ПО
			Д_ЗаявкаНаОплатуЗаявкаБезнал.СтатьяДДС,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.ЦФО,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.Ссылка,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.Ссылка.Дата,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.ИнвПроект,
			ВЫБОР
				КОГДА Д_ЗаявкаНаОплатуЗаявкаБезнал.ЦФО.УчетПоПодразделениям
					ТОГДА Д_ЗаявкаНаОплатуЗаявкаБезнал.Подразделение
				ИНАЧЕ "Основное"
			КОНЕЦ,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.Контрагент,
			Д_ЗаявкаНаОплатуЗаявкаБезнал.ИнвПроект.Код
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			Д_ЗаявкаНаАвансовыйОтчетЗатраты.Статья,
			Д_ЗаявкаНаАвансовыйОтчетЗатраты.Сумма,
			Д_ЗаявкаНаАвансовыйОтчетЗатраты.Предприятие,
			ВЫБОР
				КОГДА Д_ЗаявкаНаАвансовыйОтчетЗатраты.Предприятие.УчетПоПодразделениям
					ТОГДА Д_ЗаявкаНаАвансовыйОтчетЗатраты.Подразделение
				ИНАЧЕ "Основное"
			КОНЕЦ,
			Д_ЗаявкаНаАвансовыйОтчетЗатраты.Ссылка,
			Д_ЗаявкаНаАвансовыйОтчетЗатраты.Ссылка.Дата,
			Д_ЗаявкаНаАвансовыйОтчетЗатраты.ИнвПроект,
			ВЫБОР
				КОГДА Ложь
					ТОГДА Д_ЗаявкаНаАвансовыйОтчетЗатраты.Сумма
				ИНАЧЕ 0
			КОНЕЦ,
			Д_ЗаявкаНаАвансовыйОтчетЗатраты.Ссылка.ПодотчетноеЛицо,
			Д_ЗаявкаНаАвансовыйОтчетЗатраты.ИнвПроект.Код
		ИЗ
			Документ.Д_ЗаявкаНаАвансовыйОтчет.Затраты КАК Д_ЗаявкаНаАвансовыйОтчетЗатраты
		ГДЕ
			Д_ЗаявкаНаАвансовыйОтчетЗатраты.Ссылка.ПометкаУдаления = ЛОЖЬ
			И Д_ЗаявкаНаАвансовыйОтчетЗатраты.Ссылка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
			И (Д_ЗаявкаНаАвансовыйОтчетЗатраты.Ссылка.Предприятие В (&amp;ДоступныеПредприятия)
					ИЛИ Д_ЗаявкаНаАвансовыйОтчетЗатраты.Предприятие В (&amp;ДоступныеПредприятия)
					ИЛИ Д_ЗаявкаНаАвансовыйОтчетЗатраты.Ссылка.Автор В (&amp;Автор))
			И НЕ &amp;ИсключатьАвансовые
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			сабГрафикПлатежей.СтатьяДДС,
			сабГрафикПлатежей.Сумма,
			сабГрафикПлатежей.ЦФО,
			сабГрафикПлатежей.ПодразделениеЦФО,
			сабГрафикПлатежей.Документ,
			сабГрафикПлатежей.ДатаПлатежа,
			сабГрафикПлатежей.ДопПризнак,
			ЛОЖЬ,
			сабГрафикПлатежей.Контрагент,
			сабГрафикПлатежей.ДопПризнак.Код
		ИЗ
			РегистрСведений.сабГрафикПлатежей КАК сабГрафикПлатежей
		ГДЕ
			сабГрафикПлатежей.ДатаПлатежа &lt;= КОНЕЦПЕРИОДА(&amp;КонецПериода, ДЕНЬ)
			И (сабГрафикПлатежей.ЦФО В (&amp;ДоступныеПредприятия)
					ИЛИ сабГрафикПлатежей.Предприятие В (&amp;ДоступныеПредприятия)
					ИЛИ сабГрафикПлатежей.Документ.Автор В (&amp;Автор))
			И НЕ сабГрафикПлатежей.ТочкаМаршрута = ЗНАЧЕНИЕ(Перечисление.Согласование1ТочкиМаршрута.Завершение)
			И НЕ сабГрафикПлатежей.СтатьяДДС.Доход) КАК ВложенныйЗапрос
	
	СГРУППИРОВАТЬ ПО
		ВложенныйЗапрос.СтатьяДДС,
		ВложенныйЗапрос.ЦФО,
		ВложенныйЗапрос.Подразделение,
		ВложенныйЗапрос.ИнвПроект,
		ВложенныйЗапрос.ИнвПроектКод) КАК ТекЗаявка
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			СУММА(ВложенныйЗапрос.План1) КАК План1,
			СУММА(ВложенныйЗапрос.План2) КАК План2,
			СУММА(ВложенныйЗапрос.План3) КАК План3,
			СУММА(ВложенныйЗапрос.План4) КАК План4,
			ВложенныйЗапрос.Статья КАК Статья,
			ВложенныйЗапрос.Подразделение КАК Подразделение,
			ВложенныйЗапрос.Предприятия КАК Предприятия,
			ВложенныйЗапрос.ИнвПроект КАК ИнвПроект,
			СУММА(ВложенныйЗапрос.ПланНаСогласовании) КАК ПланНаСогласовании,
			СУММА(ВложенныйЗапрос.План_четыре) КАК План_четыре
		ИЗ
			(ВЫБРАТЬ
				СУММА(-ВЫБОР
						КОГДА БюджетныйОбороты.СценарийПлана = &amp;СценарийГод
								ИЛИ БюджетныйОбороты.СценарийПлана.Родитель В (&amp;СценарийГод)
									И БюджетныйОбороты.СценарийПлана.ВидБюджета = ЗНАЧЕНИЕ(Перечисление.Д_ВидыБюджета.ВариантБюджета)
							ТОГДА ЕСТЬNULL(БюджетныйОбороты.СуммаОборот, 0)
						ИНАЧЕ 0
					КОНЕЦ) КАК План1,
				СУММА(-ВЫБОР
						КОГДА БюджетныйОбороты.СценарийПлана = &amp;СценарийКвартал
								ИЛИ БюджетныйОбороты.СценарийПлана.Родитель В (&amp;СценарийКвартал)
									И БюджетныйОбороты.СценарийПлана.ВидБюджета = ЗНАЧЕНИЕ(Перечисление.Д_ВидыБюджета.ВариантБюджета)
							ТОГДА ЕСТЬNULL(БюджетныйОбороты.СуммаОборот, 0)
						ИНАЧЕ 0
					КОНЕЦ) КАК План2,
				СУММА(-ВЫБОР
						КОГДА БюджетныйОбороты.СценарийПлана = &amp;СценарийМесяц
								ИЛИ БюджетныйОбороты.СценарийПлана.Родитель В (&amp;СценарийМесяц)
									И БюджетныйОбороты.СценарийПлана.ВидБюджета = ЗНАЧЕНИЕ(Перечисление.Д_ВидыБюджета.ВариантБюджета)
							ТОГДА ЕСТЬNULL(БюджетныйОбороты.СуммаОборот, 0)
						ИНАЧЕ 0
					КОНЕЦ) КАК План3,
				СУММА(-ВЫБОР
						КОГДА БюджетныйОбороты.СценарийПлана = &amp;СценарийАктуальный
								ИЛИ БюджетныйОбороты.СценарийПлана = ЗНАЧЕНИЕ(Справочник.СценарииПланирования.ПустаяСсылка)
								ИЛИ БюджетныйОбороты.СценарийПлана.Родитель В (&amp;СценарийАктуальный)
									И БюджетныйОбороты.СценарийПлана.ВидБюджета = ЗНАЧЕНИЕ(Перечисление.Д_ВидыБюджета.ВариантБюджета)
							ТОГДА ЕСТЬNULL(БюджетныйОбороты.СуммаОборот, 0)
						ИНАЧЕ 0
					КОНЕЦ) КАК План4,
				БюджетныйОбороты.Субконто1 КАК Статья,
				ВЫБОР
					КОГДА БюджетныйОбороты.Предприятия.УчетПоПодразделениям
						ТОГДА БюджетныйОбороты.Подразделение
					ИНАЧЕ "Основное"
				КОНЕЦ КАК Подразделение,
				БюджетныйОбороты.Предприятия КАК Предприятия,
				ВЫБОР
					КОГДА ТИПЗНАЧЕНИЯ(БюджетныйОбороты.КорСубконто2) = ТИП(Справочник.ОбъектыСтроительства)
							И НЕ БюджетныйОбороты.КорСубконто2 = ЗНАЧЕНИЕ(Справочник.ОбъектыСтроительства.ПустаяСсылка)
						ТОГДА БюджетныйОбороты.КорСубконто2
					КОГДА ТИПЗНАЧЕНИЯ(БюджетныйОбороты.КорСубконто2) = ТИП(Справочник.ПредставительскиеРасходы)
							И НЕ БюджетныйОбороты.КорСубконто2 = ЗНАЧЕНИЕ(Справочник.ПредставительскиеРасходы.ПустаяСсылка)
						ТОГДА БюджетныйОбороты.КорСубконто2
					ИНАЧЕ НЕОПРЕДЕЛЕНО
				КОНЕЦ КАК ИнвПроект,
				0 КАК ПланНаСогласовании,
				-ВЫБОР
					КОГДА БюджетныйОбороты.СценарийПлана = &amp;СценарийАктуальный
							ИЛИ БюджетныйОбороты.СценарийПлана = ЗНАЧЕНИЕ(Справочник.СценарииПланирования.ПустаяСсылка)
							ИЛИ БюджетныйОбороты.СценарийПлана.Родитель В (&amp;СценарийАктуальный)
								И БюджетныйОбороты.СценарийПлана.ВидБюджета = ЗНАЧЕНИЕ(Перечисление.Д_ВидыБюджета.ВариантБюджета)
						ТОГДА ВЫБОР
								КОГДА Б_ПараметрыБюджета.Утвержден
										ИЛИ БюджетныйОбороты.СценарийПлана = ЗНАЧЕНИЕ(Справочник.СценарииПланирования.ПустаяСсылка)
									ТОГДА ЕСТЬNULL(БюджетныйОбороты.СуммаОборот, 0)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ 0
				КОНЕЦ КАК План_четыре
			ИЗ
				РегистрБухгалтерии.Учетный.Обороты(
						&amp;НачалоПериода,
						&amp;КонецПериода,
						,
						Счет.Родитель.Код = "50"
							ИЛИ Счет.Родитель.Код = "51",
						,
						СценарийПлана = &amp;СценарийГод
							ИЛИ СценарийПлана = &amp;СценарийКвартал
							ИЛИ СценарийПлана = &amp;СценарийМесяц
							ИЛИ СценарийПлана = ЗНАЧЕНИЕ(Справочник.СценарииПланирования.ПустаяСсылка)
							ИЛИ СценарийПлана = &amp;СценарийАктуальный
							ИЛИ СценарийПлана В
								(ВЫБРАТЬ
									СценарииПланирования.Ссылка
								ИЗ
									Справочник.СценарииПланирования КАК СценарииПланирования
								ГДЕ
									(СценарииПланирования.Родитель = &amp;СценарийГод
										ИЛИ СценарииПланирования.Родитель = &amp;СценарийКвартал
										ИЛИ СценарииПланирования.Родитель = &amp;СценарийМесяц
										ИЛИ СценарииПланирования.Родитель = ЗНАЧЕНИЕ(Справочник.СценарииПланирования.ПустаяСсылка)
										ИЛИ СценарииПланирования.Родитель = &amp;СценарийАктуальный)
									И СценарииПланирования.ВлкючатьВПлан = ИСТИНА),
						,
						) КАК БюджетныйОбороты
					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Б_ПараметрыБюджета КАК Б_ПараметрыБюджета
					ПО БюджетныйОбороты.Предприятия = Б_ПараметрыБюджета.Предприятие
						И БюджетныйОбороты.СценарийПлана = Б_ПараметрыБюджета.Сценарий
			
			СГРУППИРОВАТЬ ПО
				БюджетныйОбороты.Субконто1,
				БюджетныйОбороты.Предприятия,
				ВЫБОР
					КОГДА БюджетныйОбороты.Предприятия.УчетПоПодразделениям
						ТОГДА БюджетныйОбороты.Подразделение
					ИНАЧЕ "Основное"
				КОНЕЦ,
				ВЫБОР
					КОГДА ТИПЗНАЧЕНИЯ(БюджетныйОбороты.КорСубконто2) = ТИП(Справочник.ОбъектыСтроительства)
							И НЕ БюджетныйОбороты.КорСубконто2 = ЗНАЧЕНИЕ(Справочник.ОбъектыСтроительства.ПустаяСсылка)
						ТОГДА БюджетныйОбороты.КорСубконто2
					КОГДА ТИПЗНАЧЕНИЯ(БюджетныйОбороты.КорСубконто2) = ТИП(Справочник.ПредставительскиеРасходы)
							И НЕ БюджетныйОбороты.КорСубконто2 = ЗНАЧЕНИЕ(Справочник.ПредставительскиеРасходы.ПустаяСсылка)
						ТОГДА БюджетныйОбороты.КорСубконто2
					ИНАЧЕ НЕОПРЕДЕЛЕНО
				КОНЕЦ,
				-ВЫБОР
					КОГДА БюджетныйОбороты.СценарийПлана = &amp;СценарийАктуальный
							ИЛИ БюджетныйОбороты.СценарийПлана = ЗНАЧЕНИЕ(Справочник.СценарииПланирования.ПустаяСсылка)
							ИЛИ БюджетныйОбороты.СценарийПлана.Родитель В (&amp;СценарийАктуальный)
								И БюджетныйОбороты.СценарийПлана.ВидБюджета = ЗНАЧЕНИЕ(Перечисление.Д_ВидыБюджета.ВариантБюджета)
						ТОГДА ВЫБОР
								КОГДА Б_ПараметрыБюджета.Утвержден
										ИЛИ БюджетныйОбороты.СценарийПлана = ЗНАЧЕНИЕ(Справочник.СценарииПланирования.ПустаяСсылка)
									ТОГДА ЕСТЬNULL(БюджетныйОбороты.СуммаОборот, 0)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ 0
				КОНЕЦ
			
			ОБЪЕДИНИТЬ ВСЕ
			
			ВЫБРАТЬ
				0,
				0,
				0,
				0,
				Д_ЗаявкаНаКорректировкуБюджетаСЗ.СтатьяБДДС,
				ВЫБОР
					КОГДА Д_ЗаявкаНаКорректировкуБюджетаСЗ.ЦФО.УчетПоПодразделениям
						ТОГДА Д_ЗаявкаНаКорректировкуБюджетаСЗ.ВидДеятельности
					ИНАЧЕ "Основное"
				КОНЕЦ,
				Д_ЗаявкаНаКорректировкуБюджетаСЗ.ЦФО,
				ВЫБОР
					КОГДА Д_ЗаявкаНаКорректировкуБюджетаСЗ.ИнвПроект = ЗНАЧЕНИЕ(Справочник.ОбъектыСтроительства.ПустаяСсылка)
							ИЛИ Д_ЗаявкаНаКорректировкуБюджетаСЗ.ИнвПроект = ЗНАЧЕНИЕ(Справочник.ПредставительскиеРасходы.ПустаяСсылка)
						ТОГДА НЕОПРЕДЕЛЕНО
					ИНАЧЕ Д_ЗаявкаНаКорректировкуБюджетаСЗ.ИнвПроект
				КОНЕЦ,
				Д_ЗаявкаНаКорректировкуБюджетаСЗ.СуммаБДДС,
				0
			ИЗ
				Справочник.Согласование2 КАК Согласование2
					ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.Д_ЗаявкаНаКорректировкуБюджета.СЗ КАК Д_ЗаявкаНаКорректировкуБюджетаСЗ
					ПО Согласование2.Заявка = Д_ЗаявкаНаКорректировкуБюджетаСЗ.Ссылка
			ГДЕ
				Согласование2.ПометкаУдаления = ЛОЖЬ
				И Согласование2.Стартован = ИСТИНА
				И Согласование2.Завершен = ЛОЖЬ) КАК ВложенныйЗапрос
		
		СГРУППИРОВАТЬ ПО
			ВложенныйЗапрос.Статья,
			ВложенныйЗапрос.Подразделение,
			ВложенныйЗапрос.Предприятия,
			ВложенныйЗапрос.ИнвПроект) КАК План
		ПО ТекЗаявка.СтатьяДДС = План.Статья
			И ТекЗаявка.ЦФО = План.Предприятия
			И ТекЗаявка.Подразделение = План.Подразделение
			И (ВЫБОР
				КОГДА ТекЗаявка.ИнвПроект = НЕОПРЕДЕЛЕНО
						ИЛИ ТекЗаявка.ИнвПроект = ЗНАЧЕНИЕ(Справочник.ОбъектыСтроительства.ПустаяСсылка)
						ИЛИ ТекЗаявка.ИнвПроект = ЗНАЧЕНИЕ(Справочник.ПредставительскиеРасходы.ПустаяСсылка)
					ТОГДА План.ИнвПроект = НЕОПРЕДЕЛЕНО
				ИНАЧЕ ТекЗаявка.ИнвПроект = План.ИнвПроект
			КОНЕЦ)

СГРУППИРОВАТЬ ПО
	ТекЗаявка.СтатьяДДС,
	ТекЗаявка.ЦФО,
	ТекЗаявка.Подразделение,
	ТекЗаявка.ИнвПроект,
	ЕСТЬNULL(План.План1, 0),
	ЕСТЬNULL(План.План2, 0),
	ЕСТЬNULL(План.План3, 0),
	ЕСТЬNULL(План.План4, 0),
	ЕСТЬNULL(План.ПланНаСогласовании, 0),
	ЕСТЬNULL(План.План_четыре, 0) - ЕСТЬNULL(ТекЗаявка.СуммаДДС, 0),
	ТекЗаявка.ИнвПроектКод</query>
	</dataSet>
	<parameter>
		<name>Период</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Период</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>v8:StandardPeriod</v8:Type>
		</valueType>
		<value xsi:type="v8:StandardPeriod">
			<v8:variant xsi:type="v8:StandardPeriodVariant">Today</v8:variant>
		</value>
		<useRestriction>false</useRestriction>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>ИсключатьАвансовые</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Исключать авансовые</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>false</useRestriction>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<expression>&amp;Период.ДатаНачала</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<expression>&amp;Период.ДатаОкончания</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СценарийАктуальный</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Сценарий актуальный</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>БюджетныйНаСервере.ПолучитьАктуальныйСценарий(&amp;Период.ДатаОкончания, Ложь)</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СценарийГод</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Сценарий год</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>БюджетныйНаСервере.ПолучитьСценарийГод(&amp;Период.ДатаНачала)</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СценарийКвартал</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Сценарий квартал</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>БюджетныйНаСервере.ПолучитьСценарийКвартал(&amp;Период.ДатаНачала)</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СценарийМесяц</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Сценарий месяц</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>БюджетныйНаСервере.ПолучитьСценарийМесяц(&amp;Период.ДатаНачала)</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>Автор</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Автор</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.Пользователи</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>БПСервер.ПолучитьМассивПользователей()</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>ДоступныеПредприятия</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Доступные предприятия</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.Предприятия</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>БюджетныйНаСервере.ПолучитьПредприятия()</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:selection>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ЦФО</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Подразделение</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>СтатьяДДС</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>СтатьяДДС.Код</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ИнвПроект</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ИнвПроектКод</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Ссылка</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>План1</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>План2</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>План3</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>План4</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ПланНаСогласовании</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Заявлено</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Факт</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ФактВсего</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Отклонение</dcsset:field>
				</dcsset:item>
			</dcsset:selection>
			<dcsset:filter>
				<dcsset:userSettingID>18931f0a-9d65-46bf-a764-f65037997dfc</dcsset:userSettingID>
			</dcsset:filter>
			<dcsset:dataParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>Период</dcscor:parameter>
					<dcscor:value xsi:type="v8:StandardPeriod">
						<v8:variant xsi:type="v8:StandardPeriodVariant">Today</v8:variant>
					</dcscor:value>
					<dcsset:userSettingID>7f984402-2952-494c-8fef-33be613a06d1</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>ИсключатьАвансовые</dcscor:parameter>
					<dcscor:value xsi:type="xs:boolean">false</dcscor:value>
					<dcsset:userSettingID>feafef21-2d6d-4b9c-b8e9-8811be3332c0</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>СценарийМесяц</dcscor:parameter>
					<dcscor:value xsi:type="xs:dateTime">0001-01-01T00:00:00</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>ДоступныеПредприятия</dcscor:parameter>
					<dcscor:value xsi:type="v8:StandardPeriod">
						<v8:variant xsi:type="v8:StandardPeriodVariant">Custom</v8:variant>
						<v8:startDate>0001-01-01T00:00:00</v8:startDate>
						<v8:endDate>0001-01-01T00:00:00</v8:endDate>
					</dcscor:value>
				</dcscor:item>
			</dcsset:dataParameters>
			<dcsset:order>
				<dcsset:item xsi:type="dcsset:OrderItemField">
					<dcsset:field>ЦФО</dcsset:field>
					<dcsset:orderType>Asc</dcsset:orderType>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:OrderItemField">
					<dcsset:field>Подразделение</dcsset:field>
					<dcsset:orderType>Asc</dcsset:orderType>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:OrderItemField">
					<dcsset:field>СтатьяДДС</dcsset:field>
					<dcsset:orderType>Asc</dcsset:orderType>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:OrderItemField">
					<dcsset:field>ИнвПроект</dcsset:field>
					<dcsset:orderType>Asc</dcsset:orderType>
				</dcsset:item>
			</dcsset:order>
			<dcsset:outputParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>РасположениеИтогов</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">Auto</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ГоризонтальноеРасположениеОбщихИтогов</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">None</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВертикальноеРасположениеОбщихИтогов</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">None</dcscor:value>
				</dcscor:item>
			</dcsset:outputParameters>
			<dcsset:item xsi:type="dcsset:StructureItemGroup">
				<dcsset:order>
					<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
				</dcsset:order>
				<dcsset:selection>
					<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
				</dcsset:selection>
			</dcsset:item>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>