#Область ПрограммныйИнтерфейс

// Возвращает числовое значение ставки НДС по значению перечисления.
//
// Параметры:
// СтавкаНДС - ПеречислениеСсылка.СтавкиНДС - значение перечисления СтавкиНДС.
//
Функция ПолучитьСтавкуНДСЧислом(Знач СтавкаНДС) Экспорт
	
	Если ТипЗнч(СтавкаНДС) = Тип("СправочникСсылка.СтавкиНДС") Тогда
		Возврат СтавкаНДС.Ставка/100;	
	КонецЕсли; 	
	
	#Если Клиент Тогда
		
		Если СтавкаНДС = ПредопределенноеЗначение("Перечисление.СтавкиНДС.НДС10")
			ИЛИ СтавкаНДС = ПредопределенноеЗначение("Перечисление.СтавкиНДС.НДС10_110") Тогда
			
			Возврат 0.1;
		ИначеЕсли СтавкаНДС = ПредопределенноеЗначение("Перечисление.СтавкиНДС.НДС18")
			ИЛИ СтавкаНДС = ПредопределенноеЗначение("Перечисление.СтавкиНДС.НДС18_118") Тогда
			
			Возврат 0.18;
		ИначеЕсли СтавкаНДС = ПредопределенноеЗначение("Перечисление.СтавкиНДС.НДС20")
			ИЛИ СтавкаНДС = ПредопределенноеЗначение("Перечисление.СтавкиНДС.НДС20_120") Тогда
			
			Возврат 0.20;
		Иначе
			Возврат 0;
		КонецЕсли;
		
		
	#Иначе
		
		Если СтавкаНДС = Перечисления.СтавкиНДС.НДС10 
			ИЛИ СтавкаНДС = Перечисления.СтавкиНДС.НДС10_110 Тогда
			
			Возврат 0.1;
		ИначеЕсли СтавкаНДС = Перечисления.СтавкиНДС.НДС18
			ИЛИ СтавкаНДС = Перечисления.СтавкиНДС.НДС18_118 Тогда
			
			Возврат 0.18;
		ИначеЕсли СтавкаНДС = Перечисления.СтавкиНДС.НДС20
			ИЛИ СтавкаНДС = Перечисления.СтавкиНДС.НДС20_120 Тогда
			
			Возврат 0.20;
		Иначе
			Возврат 0;
		КонецЕсли;
		
	#КонецЕсли
	
КонецФункции

#КонецОбласти