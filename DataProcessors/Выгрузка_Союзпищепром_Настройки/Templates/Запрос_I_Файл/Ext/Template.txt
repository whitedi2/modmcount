ВЫБРАТЬ
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Дата КАК dateApplied,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Код КАК productId,
	ХозрасчетныйОбороты.КоличествоОборот КАК quantity,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ПоступлениеТоваровУслуг).НомерВходящегоДокумента КАК MTTNNum,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто2 КАК Справочник.Склады).Код КАК locId,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Наименование КАК product,
	ХозрасчетныйОбороты.Субконто1 КАК Номенклатура,
	ХозрасчетныйОбороты.Регистратор КАК Регистратор
ПОМЕСТИТЬ ВтДвижения
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, Регистратор, Счет = &Счет4101, &МассивСубконто, Организация = &Организация И Выразить(Субконто1 КАК Справочник.Номенклатура) В (&НоменклатураДляОтбора), , ) КАК ХозрасчетныйОбороты
ГДЕ
	ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ВозвратТоваровПоставщику).Дата,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Код,
	ХозрасчетныйОбороты.КоличествоОборот,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ВозвратТоваровПоставщику).Номер,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто2 КАК Справочник.Склады).Код,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Наименование,
	ХозрасчетныйОбороты.Субконто1,
	ХозрасчетныйОбороты.Регистратор
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, Регистратор, Счет = &Счет4101, &МассивСубконто, Организация = &Организация И Выразить(Субконто1 КАК Справочник.Номенклатура) В (&НоменклатураДляОтбора), , ) КАК ХозрасчетныйОбороты
ГДЕ
	ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.ВозвратТоваровПоставщику

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаПоступления).Дата,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Код,
	ХозрасчетныйОбороты.КоличествоОборот,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаПоступления).НомерВходящегоДокумента,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто2 КАК Справочник.Склады).Код,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Наименование,
	ХозрасчетныйОбороты.Субконто1,
	ХозрасчетныйОбороты.Регистратор
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, Регистратор, Счет = &Счет4101, &МассивСубконто, Организация = &Организация И Выразить(Субконто1 КАК Справочник.Номенклатура) В (&НоменклатураДляОтбора), , ) КАК ХозрасчетныйОбороты
ГДЕ
	ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.КорректировкаПоступления

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ОприходованиеТоваров).Дата,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Код,
	ХозрасчетныйОбороты.КоличествоОборот,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ОприходованиеТоваров).Номер,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто2 КАК Справочник.Склады).Код,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Наименование,
	ХозрасчетныйОбороты.Субконто1,
	ХозрасчетныйОбороты.Регистратор
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, Регистратор, Счет = &Счет4101, &МассивСубконто, Организация = &Организация И Выразить(Субконто1 КАК Справочник.Номенклатура) В (&НоменклатураДляОтбора), , ) КАК ХозрасчетныйОбороты
ГДЕ
	ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.ОприходованиеТоваров
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	МАКСИМУМ(СчетФактураПолученный.НомерВходящегоДокумента) КАК Номер,
	СчетФактураПолученный.ДокументОснование КАК ДокументОснование
ПОМЕСТИТЬ ВтСФакт
ИЗ
	Документ.СчетФактураПолученный КАК СчетФактураПолученный

СГРУППИРОВАТЬ ПО
	СчетФактураПолученный.ДокументОснование

ИНДЕКСИРОВАТЬ ПО
	ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтДвижения.dateApplied КАК dateApplied,
	ВтДвижения.productId КАК productId,
	ВтДвижения.quantity КАК quantity,
	ВтДвижения.MTTNNum КАК MTTNNum,
	ВтДвижения.locId КАК locId,
	ВтДвижения.product КАК product,
	ВтДвижения.Номенклатура КАК Номенклатура,
	ВтДвижения.Регистратор КАК Регистратор,
	ЕСТЬNULL(ВтСФакт.Номер, ВтДвижения.MTTNNum) КАК mInvNum
ИЗ
	ВтДвижения КАК ВтДвижения
		ЛЕВОЕ СОЕДИНЕНИЕ ВтСФакт КАК ВтСФакт
		ПО ВтДвижения.Регистратор = ВтСФакт.ДокументОснование