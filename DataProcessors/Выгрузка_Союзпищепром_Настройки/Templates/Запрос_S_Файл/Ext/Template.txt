ВЫБРАТЬ
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.РеализацияТоваровУслуг).Контрагент.Код КАК clientId,
	ВЫБОР
		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.РеализацияТоваровУслуг).Грузополучатель = ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
			ТОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.РеализацияТоваровУслуг).Контрагент.Код
		ИНАЧЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.РеализацияТоваровУслуг).Грузополучатель.Код
	КОНЕЦ КАК pointId,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата КАК dateApplied,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Код КАК productId,
	-ХозрасчетныйОбороты.КоличествоОборот КАК quantity,
	-ХозрасчетныйОбороты.СуммаОборот КАК sumGSV,
	-ХозрасчетныйОбороты.СуммаОборот КАК sumRP,
	ВЫБОР
		КОГДА ХозрасчетныйОбороты.Счет = &Счет90011
			ТОГДА ХозрасчетныйОбороты.Субконто2
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтавкиНДС.ПустаяСсылка)
	КОНЕЦ КАК Tax,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.РеализацияТоваровУслуг).Номер КАК rashNum,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.РеализацияТоваровУслуг).Склад.Код КАК locId,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Наименование КАК product,
	0 КАК operType,
	ХозрасчетныйОбороты.Субконто1 КАК Номенклатура,
	ХозрасчетныйОбороты.Регистратор КАК Регистратор,
	ВЫБОР
		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.РеализацияТоваровУслуг).Грузополучатель = ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
			ТОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.РеализацияТоваровУслуг).Контрагент
		ИНАЧЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.РеализацияТоваровУслуг).Грузополучатель
	КОНЕЦ КАК ПодразделениеКонтрагента,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.РеализацияТоваровУслуг).Контрагент КАК Контрагент
ПОМЕСТИТЬ ВтДвижения
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(
			&НачалоПериода,
			&КонецПериода,
			Регистратор,
			Счет = &Счет90011
				ИЛИ Счет = &Счет90012,
			&МассивСубконто,
			Организация = &Организация
				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.Номенклатура) В (&НоменклатураДляОтбора),
			,
			) КАК ХозрасчетныйОбороты
ГДЕ
	ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"Physic001",
	"Physic001",
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ОтчетОРозничныхПродажах).Дата,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Код,
	-ХозрасчетныйОбороты.КоличествоОборот,
	-ХозрасчетныйОбороты.СуммаОборот,
	-ХозрасчетныйОбороты.СуммаОборот,
	ВЫБОР
		КОГДА ХозрасчетныйОбороты.Счет = &Счет90011
			ТОГДА ХозрасчетныйОбороты.Субконто2
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтавкиНДС.ПустаяСсылка)
	КОНЕЦ,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ОтчетОРозничныхПродажах).Номер,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ОтчетОРозничныхПродажах).Склад.Код,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Наименование,
	0,
	ХозрасчетныйОбороты.Субконто1,
	ХозрасчетныйОбороты.Регистратор,
	"Physic001",
	"Physic001"
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(
			&НачалоПериода,
			&КонецПериода,
			Регистратор,
			Счет = &Счет90011
				ИЛИ Счет = &Счет90012,
			&МассивСубконто,
			Организация = &Организация
				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.Номенклатура) В (&НоменклатураДляОтбора),
			,
			) КАК ХозрасчетныйОбороты
ГДЕ
	ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.ОтчетОРозничныхПродажах

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ВозвратТоваровОтПокупателя).Контрагент.Код,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ВозвратТоваровОтПокупателя).Контрагент.Код,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ВозвратТоваровОтПокупателя).Дата,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Код,
	-ХозрасчетныйОбороты.КоличествоОборот,
	-ХозрасчетныйОбороты.СуммаОборот,
	-ХозрасчетныйОбороты.СуммаОборот,
	ВЫБОР
		КОГДА ХозрасчетныйОбороты.Счет = &Счет90011
			ТОГДА ХозрасчетныйОбороты.Субконто2
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтавкиНДС.ПустаяСсылка)
	КОНЕЦ,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ВозвратТоваровОтПокупателя).Номер,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ВозвратТоваровОтПокупателя).Склад.Код,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Наименование,
	0,
	ХозрасчетныйОбороты.Субконто1,
	ХозрасчетныйОбороты.Регистратор,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ВозвратТоваровОтПокупателя).Контрагент,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.ВозвратТоваровОтПокупателя).Контрагент
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(
			&НачалоПериода,
			&КонецПериода,
			Регистратор,
			Счет = &Счет90011
				ИЛИ Счет = &Счет90012,
			&МассивСубконто,
			Организация = &Организация
				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.Номенклатура) В (&НоменклатураДляОтбора),
			,
			) КАК ХозрасчетныйОбороты
ГДЕ
	ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.ВозвратТоваровОтПокупателя

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаРеализации).Контрагент.Код,
	ВЫБОР
		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаРеализации).Грузополучатель = ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
			ТОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаРеализации).Контрагент.Код
		ИНАЧЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаРеализации).Грузополучатель.Код
	КОНЕЦ,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаРеализации).Дата,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Код,
	-ХозрасчетныйОбороты.КоличествоОборот,
	-ХозрасчетныйОбороты.СуммаОборот,
	-ХозрасчетныйОбороты.СуммаОборот,
	ВЫБОР
		КОГДА ХозрасчетныйОбороты.Счет = &Счет90011
			ТОГДА ХозрасчетныйОбороты.Субконто2
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтавкиНДС.ПустаяСсылка)
	КОНЕЦ,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаРеализации).Номер,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаРеализации).Склад.Код,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.Номенклатура).Наименование,
	1,
	ХозрасчетныйОбороты.Субконто1,
	ХозрасчетныйОбороты.Регистратор,
	ВЫБОР
		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаРеализации).Грузополучатель = ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
			ТОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаРеализации).Контрагент
		ИНАЧЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаРеализации).Грузополучатель
	КОНЕЦ,
	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Регистратор КАК Документ.КорректировкаРеализации).Контрагент
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(
			&НачалоПериода,
			&КонецПериода,
			Регистратор,
			Счет = &Счет90011
				ИЛИ Счет = &Счет90012,
			&МассивСубконто,
			Организация = &Организация
				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.Номенклатура) В (&НоменклатураДляОтбора),
			,
			) КАК ХозрасчетныйОбороты
ГДЕ
	ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.КорректировкаРеализации

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"Waste001",
	"Waste001",
	ВЫРАЗИТЬ(Продажи.Регистратор КАК Документ.СписаниеТоваров).Дата,
	ВЫРАЗИТЬ(Продажи.Субконто1 КАК Справочник.Номенклатура).Код,
	-Продажи.КоличествоОборот,
	-Продажи.СуммаОборот,
	-Продажи.СуммаОборот,
	ЗНАЧЕНИЕ(Справочник.СтавкиНДС.ПустаяСсылка),
	ВЫРАЗИТЬ(Продажи.Регистратор КАК Документ.СписаниеТоваров).Номер,
	ВЫРАЗИТЬ(Продажи.Регистратор КАК Документ.СписаниеТоваров).Склад.Код,
	ВЫРАЗИТЬ(Продажи.Субконто1 КАК Справочник.Номенклатура).Наименование,
	0,
	Продажи.Субконто1,
	Продажи.Регистратор,
	"Waste001",
	"Waste001"
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(
			&НачалоПериода,
			&КонецПериода,
			Регистратор,
			Счет = &Счет4101,
			&МассивСубконтоСписание,
			Организация = &Организация
				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.Номенклатура) В (&НоменклатураДляОтбора),
			,
			) КАК Продажи
ГДЕ
	Продажи.Регистратор ССЫЛКА Документ.СписаниеТоваров

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"Waste001",
	"Waste001",
	ВЫРАЗИТЬ(Продажи.Регистратор КАК Документ.ТребованиеНакладная).Дата,
	ВЫРАЗИТЬ(Продажи.Субконто1 КАК Справочник.Номенклатура).Код,
	-Продажи.КоличествоОборот,
	-Продажи.СуммаОборот,
	-Продажи.СуммаОборот,
	ЗНАЧЕНИЕ(Справочник.СтавкиНДС.ПустаяСсылка),
	ВЫРАЗИТЬ(Продажи.Регистратор КАК Документ.ТребованиеНакладная).Номер,
	ВЫРАЗИТЬ(Продажи.Регистратор КАК Документ.ТребованиеНакладная).Склад.Код,
	ВЫРАЗИТЬ(Продажи.Субконто1 КАК Справочник.Номенклатура).Наименование,
	0,
	Продажи.Субконто1,
	Продажи.Регистратор,
	"Waste001",
	"Waste001"
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(
			&НачалоПериода,
			&КонецПериода,
			Регистратор,
			Счет = &Счет4101,
			&МассивСубконтоСписание,
			Организация = &Организация
				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.Номенклатура) В (&НоменклатураДляОтбора),
			,
			) КАК Продажи
ГДЕ
	Продажи.Регистратор ССЫЛКА Документ.ТребованиеНакладная
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	МАКСИМУМ(СчетФактураВыданный.Номер) КАК Номер,
	СчетФактураВыданный.ДокументОснование КАК ДокументОснование
ПОМЕСТИТЬ ВтСФакт
ИЗ
	Документ.СчетФактураВыданный КАК СчетФактураВыданный
ГДЕ
	СчетФактураВыданный.Проведен

СГРУППИРОВАТЬ ПО
	СчетФактураВыданный.ДокументОснование

ИНДЕКСИРОВАТЬ ПО
	ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	сабДанныеПоставокСрезПоследних.Номенклатура КАК Номенклатура,
	МАКСИМУМ(сабДанныеПоставокСрезПоследних.Период) КАК Период
ПОМЕСТИТЬ ВТЦеныСоСкладами
ИЗ
	РегистрСведений.сабДанныеПоставок.СрезПоследних(
			,
			Номенклатура В (&НоменклатураДляОтбора)
				И Предприятие.ОсновнаяОрганизация = &Организация) КАК сабДанныеПоставокСрезПоследних

СГРУППИРОВАТЬ ПО
	сабДанныеПоставокСрезПоследних.Номенклатура
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТЦеныСоСкладами.Номенклатура КАК Номенклатура,
	МАКСИМУМ(сабДанныеПоставокСрезПоследних.Цена) КАК Цена
ПОМЕСТИТЬ ВТЦены
ИЗ
	ВТЦеныСоСкладами КАК ВТЦеныСоСкладами
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.сабДанныеПоставок.СрезПоследних(
				,
				Номенклатура В (&НоменклатураДляОтбора)
					И Предприятие.ОсновнаяОрганизация = &Организация) КАК сабДанныеПоставокСрезПоследних
		ПО ВТЦеныСоСкладами.Номенклатура = сабДанныеПоставокСрезПоследних.Номенклатура
			И ВТЦеныСоСкладами.Период = сабДанныеПоставокСрезПоследних.Период

СГРУППИРОВАТЬ ПО
	ВТЦеныСоСкладами.Номенклатура
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтДвижения.clientId КАК clientId,
	ВтДвижения.pointId КАК pointId,
	ВтДвижения.dateApplied КАК dateApplied,
	ВтДвижения.productId КАК productId,
	ВтДвижения.quantity КАК quantity,
	ВтДвижения.sumGSV КАК sumGSV,
	ВтДвижения.sumRP КАК sumRP,
	ВтДвижения.Tax КАК Tax,
	ВтДвижения.rashNum КАК rashNum,
	ВтДвижения.locId КАК locId,
	ВтДвижения.product КАК product,
	ВтДвижения.operType КАК operType,
	ВтДвижения.Номенклатура КАК Номенклатура,
	ВтДвижения.Регистратор КАК Регистратор,
	ВтДвижения.ПодразделениеКонтрагента КАК ПодразделениеКонтрагента,
	ЕСТЬNULL(ВтСФакт.Номер, ВтДвижения.rashNum) КАК invNum,
	ВтДвижения.quantity * ЕСТЬNULL(ВТЦены.Цена, 0) КАК sumNSV,
	ВЫБОР
		КОГДА ЕСТЬNULL(ОтветственныеСрезПоследних.Ответственный, "") = ""
			ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
		КОГДА ТИПЗНАЧЕНИЯ(ОтветственныеСрезПоследних.Ответственный) = ТИП(Справочник.Сотрудники)
			ТОГДА ОтветственныеСрезПоследних.Ответственный.ФизическоеЛицо
		ИНАЧЕ ОтветственныеСрезПоследних.Ответственный
	КОНЕЦ КАК ОтветственныйФиз,
	ВЫБОР
		КОГДА ЕСТЬNULL(ОтветственныеСрезПоследних.Ответственный, "") = ""
			ТОГДА ""
		КОГДА ТИПЗНАЧЕНИЯ(ОтветственныеСрезПоследних.Ответственный) = ТИП(Справочник.Сотрудники)
			ТОГДА ОтветственныеСрезПоследних.Ответственный.ФизическоеЛицо.Код
		ИНАЧЕ ОтветственныеСрезПоследних.Ответственный.Код
	КОНЕЦ КАК manId,
	ВЫБОР
		КОГДА ЕСТЬNULL(ОтветственныеСрезПоследних.Ответственный, "") = ""
			ТОГДА ""
		КОГДА ТИПЗНАЧЕНИЯ(ОтветственныеСрезПоследних.Ответственный) = ТИП(Справочник.Сотрудники)
			ТОГДА ОтветственныеСрезПоследних.Ответственный.ФизическоеЛицо.ФИО
		ИНАЧЕ ОтветственныеСрезПоследних.Ответственный.ФИО
	КОНЕЦ КАК ОтветственныйФИО,
	ВтДвижения.Контрагент КАК Контрагент
ИЗ
	ВтДвижения КАК ВтДвижения
		ЛЕВОЕ СОЕДИНЕНИЕ ВтСФакт КАК ВтСФакт
		ПО ВтДвижения.Регистратор = ВтСФакт.ДокументОснование
		ЛЕВОЕ СОЕДИНЕНИЕ ВТЦены КАК ВТЦены
		ПО ВтДвижения.Номенклатура = ВТЦены.Номенклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Ответственные.СрезПоследних(&КонецПериода, ) КАК ОтветственныеСрезПоследних
		ПО ВтДвижения.ПодразделениеКонтрагента = ОтветственныеСрезПоследних.Контрагент