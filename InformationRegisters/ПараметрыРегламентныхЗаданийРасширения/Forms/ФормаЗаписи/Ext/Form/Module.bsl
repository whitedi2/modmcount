&НаКлиенте
Процедура Расписание(Команда)
	ПараметрыЗадания = ОпределитьПараметрыЗадания();
	
	
	Если ПараметрыЗадания = Неопределено Тогда
		Сообщить("Настройка расписания невозможна. Возможно регламентное задание ещё не записано!");
		Возврат;		
	КонецЕсли;
	
	ОткрытьФорму("Обработка.РегламентныеИФоновыеЗадания.Форма.РегламентноеЗадание",ПараметрыЗадания,ЭтаФорма,,,,,РежимОткрытияОкнаФормы.БлокироватьВесьИнтерфейс);
	
КонецПроцедуры

&НаСервере
Функция ОпределитьПараметрыЗадания()
	
	ПараметрыЗадания = Новый Структура;
	Если РегламентныеЗаданияСервер.Задание(Запись.Идентификатор) =  Неопределено Тогда
		//ПараметрыЗадания.Вставить("Идентификатор", Новый УникальныйИдентификатор);
		//ПараметрыЗадания.Вставить("Действие", "Добавить");		
		//Запись.Идентификатор = ПараметрыЗадания.Идентификатор;
		Возврат Неопределено;		
	Иначе 
		ПараметрыЗадания.Вставить("Идентификатор", Запись.Идентификатор);
		ПараметрыЗадания.Вставить("Действие", "Изменить");
	КонецЕсли;
	
	Возврат ПараметрыЗадания;
		
КонецФункции

&НаКлиенте
Процедура ОбработкаОповещения(ИмяСобытия, Параметр, Источник)
	Если ИмяСобытия = "Запись_РегламентныеЗадания" Тогда
		ЭтаФорма.Запись.Использование = ПолучитьИспользование(Параметр);
		ЭтаФорма.Записать();
	КонецЕсли;
КонецПроцедуры

Функция ПолучитьИспользование(Параметр)
	Возврат РегламентныеЗаданияСервер.Задание(Параметр).Использование;	
КонецФункции

&НаКлиенте
Процедура РегламентныеИФоновыеЗадания(Команда)
	ОткрытьФорму("Обработка.РегламентныеИФоновыеЗадания.Форма.РегламентныеИФоновыеЗадания");
КонецПроцедуры
